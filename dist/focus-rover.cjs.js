"use strict";var Default={vertical:!0,horizontal:!0,wrap:!0,initialFocusIndex:0,resetOnExit:!1},Backward=Symbol("backward"),Forward=Symbol("forward"),Rover=function(t,e){var r=t||[],i=e;"object"==typeof t&&(t instanceof NodeList?r=Array.from(t):(r=[],i=t)),this.elements=r,this.default=Default,this.config=Object.assign({},Default,i),this.elements.length&&this.init(!0)},prototypeAccessors={currentElement:{},backward:{},forward:{},lastIndex:{},validKeys:{}};Rover.prototype.init=function(t){var e=this;return this.elements.forEach(function(r,i){e.initTabindex(r,i),t&&e.setListeners(r,i)}),this},Rover.prototype.initTabindex=function(t,e){return e===this.config.initialFocusIndex?t.getAttribute("href")?t.removeAttribute("tabindex"):t.setAttribute("tabindex",0):t.setAttribute("tabindex",-1),this},Rover.prototype.setListeners=function(t,e){var r=this,i=this.elements.filter(function(e){return e!==t});return t.addEventListener("keydown",function(t){if(r.validKeys.includes(t.code)){t.preventDefault();var i=r.nextIndex(e,r.forward.includes(t.code));r.elements[i].focus()}}),t.addEventListener("focusin",function(e){e.target!==r.currentElement&&(Rover.activate(t),i.forEach(function(t){return Rover.deactivate(t)}))}),t.addEventListener("blur",function(t){var e=t.relatedTarget;r.config.resetOnExit&&!r.elements.includes(e)&&r.init(!1)}),this},Rover.prototype.nextIndex=function(t,e){return e?t===this.lastIndex?this.config.wrap?0:t:t+1:0===t?this.config.wrap?this.lastIndex:t:t-1},prototypeAccessors.currentElement.get=function(){return this.elements.find(function(t){return"-1"!==t.getAttribute("tabindex")})},prototypeAccessors.backward.get=function(){return this[Backward]||(this[Backward]=[],this.config.vertical&&this[Backward].push("ArrowUp"),this.config.horizontal&&this[Backward].push("ArrowLeft")),this[Backward]},prototypeAccessors.forward.get=function(){return this[Forward]||(this[Forward]=[],this.config.vertical&&this[Forward].push("ArrowDown"),this.config.horizontal&&this[Forward].push("ArrowRight")),this[Forward]},prototypeAccessors.lastIndex.get=function(){return this.elements.length-1},prototypeAccessors.validKeys.get=function(){return this.backward.concat(this.forward)||[]},Rover.activate=function(t){return t.getAttribute("href")?t.removeAttribute("tabindex"):t.setAttribute("tabindex",0),this},Rover.deactivate=function(t){return t.setAttribute("tabindex",-1),this},Object.defineProperties(Rover.prototype,prototypeAccessors),module.exports=Rover;
