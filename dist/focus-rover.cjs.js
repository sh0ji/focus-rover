"use strict";var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},Default={vertical:!0,horizontal:!0,wrap:!0,initialFocusIndex:0,resetOnExit:!1},Backward=Symbol("backward"),Forward=Symbol("forward"),Rover=function(){function t(e,r){classCallCheck(this,t),this.elements=e,this.default=Default,this.config=Object.assign({},Default,r),this.elements.length&&this.init(!0)}return createClass(t,[{key:"init",value:function(t){var e=this;return this.elements.forEach(function(r,n){e.initTabindex(r,n),t&&e.setListeners(r,n)}),this}},{key:"initTabindex",value:function(t,e){return e===this.config.initialFocusIndex?t.getAttribute("href")?t.removeAttribute("tabindex"):t.setAttribute("tabindex",0):t.setAttribute("tabindex",-1),this}},{key:"setListeners",value:function(e,r){var n=this;return e.addEventListener("keydown",function(i){if(n.validKeys.includes(i.code)){i.preventDefault();var a=n.nextIndex(r,n.forward.includes(i.code));t.moveFocus(e,n.elements[a])}}),e.addEventListener("blur",function(t){var e=t.relatedTarget;n.config.resetOnExit&&![].concat(toConsumableArray(n.elements)).includes(e)&&n.init(!1)}),this}},{key:"nextIndex",value:function(t,e){return e?t===this.lastIndex?this.config.wrap?0:t:t+1:0===t?this.config.wrap?this.lastIndex:t:t-1}},{key:"backward",get:function(){return this[Backward]||(this[Backward]=[],this.config.vertical&&this[Backward].push("ArrowUp"),this.config.horizontal&&this[Backward].push("ArrowLeft")),this[Backward]}},{key:"forward",get:function(){return this[Forward]||(this[Forward]=[],this.config.vertical&&this[Forward].push("ArrowDown"),this.config.horizontal&&this[Forward].push("ArrowRight")),this[Forward]}},{key:"lastIndex",get:function(){return this.elements.length-1}},{key:"validKeys",get:function(){return this.backward.concat(this.forward)||[]}}],[{key:"moveFocus",value:function(t,e){return t.setAttribute("tabindex",-1),e.getAttribute("href")?e.removeAttribute("tabindex"):e.setAttribute("tabindex",0),e.focus(),this}}]),t}();module.exports=Rover;
