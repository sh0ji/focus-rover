!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Rover=e()}(this,function(){"use strict";var t={vertical:!0,horizontal:!0,wrap:!0,initialFocusIndex:0,resetOnExit:!1},e=Symbol("backward"),i=Symbol("forward"),n=function(e,i){var n=e||[],r=i;"object"==typeof e&&(e instanceof NodeList?n=Array.from(e):(n=[],r=e)),this.elements=n,this.default=t,this.config=Object.assign({},t,r),this.elements.length&&this.init(!0)},r={currentElement:{},backward:{},forward:{},lastIndex:{},validKeys:{}};return n.prototype.init=function(t){var e=this;return this.elements.forEach(function(i,n){e.initTabindex(i,n),t&&e.setListeners(i,n)}),this},n.prototype.initTabindex=function(t,e){return e===this.config.initialFocusIndex?t.getAttribute("href")?t.removeAttribute("tabindex"):t.setAttribute("tabindex",0):t.setAttribute("tabindex",-1),this},n.prototype.setListeners=function(t,e){var i=this,r=this.elements.filter(function(e){return e!==t});return t.addEventListener("keydown",function(t){if(i.validKeys.includes(t.code)){t.preventDefault();var n=i.nextIndex(e,i.forward.includes(t.code));i.elements[n].focus()}}),t.addEventListener("focusin",function(e){e.target!==i.currentElement&&(n.activate(t),r.forEach(function(t){return n.deactivate(t)}))}),t.addEventListener("blur",function(t){var e=t.relatedTarget;i.config.resetOnExit&&!i.elements.includes(e)&&i.init(!1)}),this},n.prototype.nextIndex=function(t,e){return e?t===this.lastIndex?this.config.wrap?0:t:t+1:0===t?this.config.wrap?this.lastIndex:t:t-1},r.currentElement.get=function(){return this.elements.find(function(t){return"-1"!==t.getAttribute("tabindex")})},r.backward.get=function(){return this[e]||(this[e]=[],this.config.vertical&&this[e].push("ArrowUp"),this.config.horizontal&&this[e].push("ArrowLeft")),this[e]},r.forward.get=function(){return this[i]||(this[i]=[],this.config.vertical&&this[i].push("ArrowDown"),this.config.horizontal&&this[i].push("ArrowRight")),this[i]},r.lastIndex.get=function(){return this.elements.length-1},r.validKeys.get=function(){return this.backward.concat(this.forward)||[]},n.activate=function(t){return t.getAttribute("href")?t.removeAttribute("tabindex"):t.setAttribute("tabindex",0),this},n.deactivate=function(t){return t.setAttribute("tabindex",-1),this},Object.defineProperties(n.prototype,r),n});
